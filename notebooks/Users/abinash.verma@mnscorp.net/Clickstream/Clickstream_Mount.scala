// Databricks notebook source
val StorageAccount = "storagecctav"
val Container = "clickstream"
val MountPoint = "/mnt/Clickstream"
val SASKey = "?sv=2017-11-09&ss=bfqt&srt=sco&sp=rwdlacup&se=2018-07-31T15:07:36Z&st=2018-07-13T07:07:36Z&spr=https&sig=cJWD2p5QeE6Gg07p6tvrflL9u3i6T0ePYpZG1UMGTUk%3D"


val SourceStr = s"wasbs://$Container@$StorageAccount.blob.core.windows.net/"
val ConfKey = s"fs.azure.sas.$Container.$StorageAccount.blob.core.windows.net"


// COMMAND ----------

try {
  dbutils.fs.mount(
    source = SourceStr,
    mountPoint = MountPoint,
    extraConfigs = Map(ConfKey -> SASKey)
  )
}
catch {
  case e: Exception =>
    println(s"*** ERROR: Unable to mount $MountPoint. Run previous cells to unmount first")
}


// COMMAND ----------

// MAGIC %fs ls /mnt/onprem_data/blob/warehouse/base/prod/clickstream_base_prod.db/clickstream/

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC select * from 
// MAGIC  perf_test_blob.clickstream where year = 2017 and month = 12 and day = 3 
// MAGIC  limit 10 ;

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC 
// MAGIC 
// MAGIC 
// MAGIC CREATE TABLE perf_test_blob.clickstream (
// MAGIC   eah_load_date TIMESTAMP,
// MAGIC   clickstream_key STRING,
// MAGIC   cookie_id STRING,
// MAGIC   visit_id BIGINT,
// MAGIC   page_id BIGINT,
// MAGIC   page_num SMALLINT,
// MAGIC   page_event SMALLINT,
// MAGIC   visit_page_num SMALLINT,
// MAGIC   date_time TIMESTAMP,
// MAGIC   page_url STRING,
// MAGIC   page_url_truncated STRING,
// MAGIC   post_visid_high STRING,
// MAGIC   post_visid_low STRING,
// MAGIC   visit_num SMALLINT,
// MAGIC   visit_start_time_gmt BIGINT,
// MAGIC   page_event_var2 STRING,
// MAGIC   j_jscript DECIMAL(9,1),
// MAGIC   visid_type SMALLINT,
// MAGIC   connection_type SMALLINT,
// MAGIC   duplicate_purchase SMALLINT,
// MAGIC   pagename STRING,
// MAGIC   ref_type SMALLINT,
// MAGIC   first_hit_time_gmt BIGINT,
// MAGIC   search_engine BIGINT,
// MAGIC   os BIGINT,
// MAGIC   browser BIGINT,
// MAGIC   browser_height BIGINT,
// MAGIC   browser_width BIGINT,
// MAGIC   mobile_id BIGINT,
// MAGIC   hit_source SMALLINT,
// MAGIC   exclude_hit SMALLINT,
// MAGIC   pim_id STRING,
// MAGIC   geo_country STRING,
// MAGIC   geo_city STRING,
// MAGIC   geo_region STRING,
// MAGIC   geo_zip STRING,
// MAGIC   ip STRING,
// MAGIC   page_type STRING,
// MAGIC   event_list STRING,
// MAGIC   carrier STRING,
// MAGIC   cookies STRING,
// MAGIC   currency STRING,
// MAGIC   cust_visid STRING,
// MAGIC   domain STRING,
// MAGIC   first_hit_page_url STRING,
// MAGIC   first_hit_pagename STRING,
// MAGIC   first_hit_referrer STRING,
// MAGIC   java_enabled STRING,
// MAGIC   mcvisid STRING,
// MAGIC   mvvar1 STRING,
// MAGIC   mvvar2 STRING,
// MAGIC   mvvar3 STRING,
// MAGIC   persistent_cookie STRING,
// MAGIC   state STRING,
// MAGIC   tnt STRING,
// MAGIC   tnt_action STRING,
// MAGIC   ref_domain STRING,
// MAGIC   truncated_hit STRING,
// MAGIC   user_agent STRING,
// MAGIC   user_server STRING,
// MAGIC   campaign STRING,
// MAGIC   product_list STRING,
// MAGIC   post_evar36 STRING,
// MAGIC   post_evar75 STRING,
// MAGIC   post_purchaseid STRING,
// MAGIC   post_channel STRING,
// MAGIC   evar1 STRING,
// MAGIC   evar2 STRING,
// MAGIC   evar3 STRING,
// MAGIC   evar4 STRING,
// MAGIC   evar5 STRING,
// MAGIC   evar6 STRING,
// MAGIC   evar7 STRING,
// MAGIC   evar8 STRING,
// MAGIC   evar9 STRING,
// MAGIC   evar10 STRING,
// MAGIC   evar11 STRING,
// MAGIC   evar12 STRING,
// MAGIC   evar13 STRING,
// MAGIC   evar14 STRING,
// MAGIC   evar15 STRING,
// MAGIC   evar16 STRING,
// MAGIC   evar17 STRING,
// MAGIC   evar18 STRING,
// MAGIC   evar19 STRING,
// MAGIC   evar20 STRING,
// MAGIC   evar21 STRING,
// MAGIC   evar22 STRING,
// MAGIC   evar23 STRING,
// MAGIC   evar24 STRING,
// MAGIC   evar25 STRING,
// MAGIC   evar26 STRING,
// MAGIC   evar27 STRING,
// MAGIC   evar28 STRING,
// MAGIC   evar29 STRING,
// MAGIC   evar30 STRING,
// MAGIC   evar31 STRING,
// MAGIC   evar32 STRING,
// MAGIC   evar33 STRING,
// MAGIC   evar34 STRING,
// MAGIC   evar35 STRING,
// MAGIC   evar36 STRING,
// MAGIC   evar37 STRING,
// MAGIC   evar38 STRING,
// MAGIC   evar39 STRING,
// MAGIC   evar40 STRING,
// MAGIC   evar41 STRING,
// MAGIC   evar42 STRING,
// MAGIC   evar43 STRING,
// MAGIC   evar44 STRING,
// MAGIC   evar45 STRING,
// MAGIC   evar46 STRING,
// MAGIC   evar47 STRING,
// MAGIC   evar48 STRING,
// MAGIC   evar49 STRING,
// MAGIC   evar50 STRING,
// MAGIC   evar51 STRING,
// MAGIC   evar52 STRING,
// MAGIC   evar53 STRING,
// MAGIC   evar54 STRING,
// MAGIC   evar55 STRING,
// MAGIC   evar56 STRING,
// MAGIC   evar57 STRING,
// MAGIC   evar58 STRING,
// MAGIC   evar59 STRING,
// MAGIC   evar60 STRING,
// MAGIC   evar61 STRING,
// MAGIC   evar62 STRING,
// MAGIC   evar63 STRING,
// MAGIC   evar64 STRING,
// MAGIC   evar65 STRING,
// MAGIC   evar66 STRING,
// MAGIC   evar67 STRING,
// MAGIC   evar68 STRING,
// MAGIC   evar69 STRING,
// MAGIC   evar70 STRING,
// MAGIC   evar71 STRING,
// MAGIC   evar72 STRING,
// MAGIC   evar73 STRING,
// MAGIC   evar74 STRING,
// MAGIC   evar75 STRING,
// MAGIC   post_prop1 STRING,
// MAGIC   post_prop2 STRING,
// MAGIC   post_prop3 STRING,
// MAGIC   post_prop4 STRING,
// MAGIC   post_prop5 STRING,
// MAGIC   post_prop6 STRING,
// MAGIC   post_prop7 STRING,
// MAGIC   post_prop8 STRING,
// MAGIC   post_prop9 STRING,
// MAGIC   post_prop10 STRING,
// MAGIC   post_prop11 STRING,
// MAGIC   post_prop12 STRING,
// MAGIC   post_prop13 STRING,
// MAGIC   post_prop14 STRING,
// MAGIC   post_prop15 STRING,
// MAGIC   post_prop16 STRING,
// MAGIC   post_prop17 STRING,
// MAGIC   post_prop18 STRING,
// MAGIC   post_prop19 STRING,
// MAGIC   post_prop20 STRING,
// MAGIC   post_prop21 STRING,
// MAGIC   post_prop22 STRING,
// MAGIC   post_prop23 STRING,
// MAGIC   post_prop24 STRING,
// MAGIC   post_prop25 STRING,
// MAGIC   post_prop26 STRING,
// MAGIC   post_prop27 STRING,
// MAGIC   post_prop28 STRING,
// MAGIC   post_prop29 STRING,
// MAGIC   post_prop30 STRING,
// MAGIC   post_prop31 STRING,
// MAGIC   post_prop32 STRING,
// MAGIC   post_prop33 STRING,
// MAGIC   post_prop34 STRING,
// MAGIC   post_prop35 STRING,
// MAGIC   post_prop36 STRING,
// MAGIC   post_prop37 STRING,
// MAGIC   post_prop38 STRING,
// MAGIC   post_prop39 STRING,
// MAGIC   post_prop40 STRING,
// MAGIC   post_prop41 STRING,
// MAGIC   post_prop42 STRING,
// MAGIC   post_prop43 STRING,
// MAGIC   post_prop44 STRING,
// MAGIC   post_prop45 STRING,
// MAGIC   post_prop46 STRING,
// MAGIC   post_prop47 STRING,
// MAGIC   post_prop48 STRING,
// MAGIC   post_prop49 STRING,
// MAGIC   post_prop50 STRING,
// MAGIC   post_prop51 STRING,
// MAGIC   post_prop52 STRING,
// MAGIC   post_prop53 STRING,
// MAGIC   post_prop54 STRING,
// MAGIC   post_prop55 STRING,
// MAGIC   post_prop56 STRING,
// MAGIC   post_prop57 STRING,
// MAGIC   post_prop58 STRING,
// MAGIC   post_prop59 STRING,
// MAGIC   post_prop60 STRING,
// MAGIC   post_prop61 STRING,
// MAGIC   post_prop62 STRING,
// MAGIC   post_prop63 STRING,
// MAGIC   post_prop64 STRING,
// MAGIC   post_prop65 STRING,
// MAGIC   post_prop66 STRING,
// MAGIC   post_prop67 STRING,
// MAGIC   post_prop68 STRING,
// MAGIC   post_prop69 STRING,
// MAGIC   post_prop70 STRING,
// MAGIC   post_prop71 STRING,
// MAGIC   post_prop72 STRING,
// MAGIC   post_prop73 STRING,
// MAGIC   post_prop74 STRING,
// MAGIC   post_prop75 STRING,
// MAGIC   post_event_list STRING,
// MAGIC   post_product_list_raw STRING,
// MAGIC   post_campaign STRING,
// MAGIC   post_evar29 STRING,
// MAGIC   login_status STRING,
// MAGIC   platform_hit STRING,
// MAGIC   site_section_v2 STRING,
// MAGIC   pagename_missing STRING,
// MAGIC   pagetail_raw STRING,
// MAGIC   internal_tracking_code STRING,
// MAGIC   mkting_channel_raw STRING,
// MAGIC   post_mkting_channel_raw STRING,
// MAGIC   merch_bu STRING,
// MAGIC   interaction_type STRING,
// MAGIC   page_event_var2_raw STRING,
// MAGIC   repeat_num_page_mkting_invisit BIGINT,
// MAGIC   repeat_num_page_invisit BIGINT,
// MAGIC   repeat_page_id_prev STRING,
// MAGIC   repeat_page_id_next STRING,
// MAGIC   year SMALLINT, 
// MAGIC   month TINYINT, 
// MAGIC   day TINYINT, 
// MAGIC   dte_int INT, 
// MAGIC   dte_str STRING
// MAGIC ) Using PARQUET
// MAGIC PARTITIONED BY (year,month,day,dte_int,dte_str)
// MAGIC LOCATION '/mnt/onprem_data/blob/warehouse/base/prod/clickstream_base_prod.db/clickstream'

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC MSCK REPAIR TABLE perf_test_blob.clickstream

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC show partitions perf_test_blob.clickstream

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC 
// MAGIC 
// MAGIC CREATE TABLE perf_test_blob.dept_bu_lkp (                                                                                                                 
// MAGIC    dept STRING,                                                                                                                                                   
// MAGIC    bu STRING,                                                                                                                                                     
// MAGIC    bu_online STRING                                                                                                                                               
// MAGIC )                                                                                                                                                                
// MAGIC USING PARQUET                                                                                                                                                
// MAGIC LOCATION '/mnt/onprem_data/blob/warehouse/base/prod/clickstream_base_prod.db/dept_bu_lkp/'

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC CREATE TABLE perf_test_blob.dept_bu_product_lkp (                                                                                                                
// MAGIC    product_id STRING,    
// MAGIC    bu STRING,
// MAGIC    dept STRING
// MAGIC  )
// MAGIC  USING PARQUET
// MAGIC  LOCATION '/mnt/onprem_data/blob/warehouse/base/prod/clickstream_base_prod.db/dept_bu_product_lkp/'

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC  CREATE TABLE perf_test_blob.dept_bu_article_lkp (                                                                                                                 
// MAGIC    article_no STRING,
// MAGIC    product_id STRING,
// MAGIC    description STRING,
// MAGIC    bu STRING,
// MAGIC    dept STRING,
// MAGIC    p_product_id STRING,
// MAGIC    pim_article_no STRING,
// MAGIC    p_producturl STRING,
// MAGIC    p_mfpartnumber STRING,
// MAGIC    p_fullimageurl STRING
// MAGIC  )                                                                                                                                                  
// MAGIC  USING PARQUET
// MAGIC  LOCATION '/mnt/onprem_data/blob/warehouse/base/prod/clickstream_base_prod.db/dept_bu_article_lkp/'   

// COMMAND ----------

// MAGIC %sql
// MAGIC  CREATE TABLE perf_test_blob.dim_article (                                                                
// MAGIC    merchandising_id BIGINT,                                                                             
// MAGIC    article_id BIGINT,                                                                                   
// MAGIC    article_no VARCHAR(18),                                                                              
// MAGIC    variant_no VARCHAR(18),                                                                              
// MAGIC    upc VARCHAR(8),                                                                                      
// MAGIC    article_short_name VARCHAR(40),                                                                      
// MAGIC    article_name VARCHAR(40),                                                                            
// MAGIC    article_type VARCHAR(4),                                                                             
// MAGIC    article_cat VARCHAR(2),                                                                              
// MAGIC    merchandise_cat VARCHAR(9),                                                                          
// MAGIC    basic_view_ind CHAR(1),                                                                              
// MAGIC    sales_view_ind CHAR(1),                                                                              
// MAGIC    logistics_dc_view_ind VARCHAR(1),                                                                    
// MAGIC    pos_view_ind CHAR(1),                                                                                
// MAGIC    creation_date TIMESTAMP,                                                                             
// MAGIC    ext_merchandise_cat VARCHAR(18),                                                                     
// MAGIC    prod_type VARCHAR(18),                                                                               
// MAGIC    ean VARCHAR(18),                                                                                     
// MAGIC    price_band_cat VARCHAR(2),                                                                           
// MAGIC    season_cat VARCHAR(4),                                                                               
// MAGIC    season_yr VARCHAR(4),                                                                                
// MAGIC    tax_classification VARCHAR(1),                                                                       
// MAGIC    tax_percentage VARCHAR(9),                                                                           
// MAGIC    storage_conditions VARCHAR(2),                                                                       
// MAGIC    transport_group VARCHAR(4),                                                                          
// MAGIC    net_contents VARCHAR(15),                                                                            
// MAGIC    comparison_price_unit VARCHAR(6),                                                                    
// MAGIC    temp_conditions_ind VARCHAR(2),                                                                      
// MAGIC    auth_grp VARCHAR(4),                                                                                 
// MAGIC    variant_pricing_profile VARCHAR(1),                                                                  
// MAGIC    content_unit VARCHAR(3),                                                                             
// MAGIC    creation_status VARCHAR(2),                                                                          
// MAGIC    brand_id VARCHAR(4),                                                                                 
// MAGIC    stroke VARCHAR(5),                                                                                   
// MAGIC    core_newness VARCHAR(2),                                                                             
// MAGIC    buying_ratio_code VARCHAR(8),                                                                        
// MAGIC    pri_size_range VARCHAR(2),                                                                           
// MAGIC    sec_size_range VARCHAR(2),                                                                           
// MAGIC    pri_size_index VARCHAR(2),                                                                           
// MAGIC    sec_size_index VARCHAR(2),                                                                           
// MAGIC    min_display_faces INT,                                                                               
// MAGIC    max_display_units INT,                                                                               
// MAGIC    colour_code VARCHAR(18),                                                                             
// MAGIC    order_type_code VARCHAR(2),                                                                          
// MAGIC    customs_duty_pref_ind VARCHAR(2),                                                                    
// MAGIC    license_char_usage_ind VARCHAR(2),                                                                   
// MAGIC    design_ref_no VARCHAR(30),                                                                           
// MAGIC    customs_duty_grp VARCHAR(5),                                                                         
// MAGIC    reproces_complex_ind VARCHAR(2),                                                                     
// MAGIC    segregation_ind VARCHAR(2),                                                                          
// MAGIC    till_card_ind VARCHAR(2),                                                                            
// MAGIC    bar_code_ind CHAR(1),                                                                                
// MAGIC    display_method VARCHAR(2),                                                                           
// MAGIC    display_orientation VARCHAR(2),                                                                      
// MAGIC    alcohol_percentage VARCHAR(4),                                                                       
// MAGIC    allocation_range VARCHAR(3),                                                                         
// MAGIC    action_date TIMESTAMP,                                                                               
// MAGIC    custom_made_ind CHAR(1),                                                                             
// MAGIC    gift_card_ind CHAR(1),                                                                               
// MAGIC    boxhanger_ind CHAR(1),                                                                               
// MAGIC    tv_tuner_ind CHAR(1),                                                                                
// MAGIC    location_code VARCHAR(10),                                                                           
// MAGIC    freight_cost_grp VARCHAR(2),                                                                         
// MAGIC    flow_line_ind CHAR(1),                                                                               
// MAGIC    info_rec_cat VARCHAR(2),                                                                             
// MAGIC    net_purchase_price DECIMAL(18,5),                                                                    
// MAGIC    net_sales_price DECIMAL(18,5),                                                                       
// MAGIC    intl_article_no_count VARCHAR(3),                                                                    
// MAGIC    purchasing_grp VARCHAR(3),                                                                           
// MAGIC    assortment_type_ind CHAR(1),                                                                         
// MAGIC    commodity_code_no VARCHAR(17),                                                                       
// MAGIC    origin_ctry_code VARCHAR(3),                                                                         
// MAGIC    display_qty VARCHAR(13),                                                                             
// MAGIC    pos_article_desc_unit VARCHAR(40),                                                                   
// MAGIC    pos_consecutive_no VARCHAR(2),                                                                       
// MAGIC    pos_text_id VARCHAR(2),                                                                              
// MAGIC    pos_lang_code VARCHAR(2),                                                                            
// MAGIC    pos_lang_key VARCHAR(1),                                                                             
// MAGIC    pos_gen_alt_unit_iso_code VARCHAR(3),                                                                
// MAGIC    pos_gen_alt_uom VARCHAR(3),                                                                          
// MAGIC    pos_loose_code VARCHAR(4),                                                                           
// MAGIC    pos_pri_sales_org VARCHAR(4),                                                                        
// MAGIC    pos_pri_distr_channel VARCHAR(2),                                                                    
// MAGIC    pos_cust_shelf_life VARCHAR(1),                                                                      
// MAGIC    pos_unit_type_code VARCHAR(2),                                                                       
// MAGIC    pos_coupon_accept_ind VARCHAR(3),                                                                    
// MAGIC    pos_service_warranty_ind VARCHAR(3),                                                                 
// MAGIC    pos_sec_sales_org VARCHAR(4),                                                                        
// MAGIC    pos_sec_distr_channel VARCHAR(2),                                                                    
// MAGIC    delv_mthd VARCHAR(2),                                                                                
// MAGIC    sub_dept VARCHAR(4),                                                                                 
// MAGIC    art_hier_lev1_code VARCHAR(100),                                                                     
// MAGIC    art_hier_lev1_name VARCHAR(100),                                                                     
// MAGIC    art_hier_lev2_code VARCHAR(100),                                                                     
// MAGIC    art_hier_lev2_name VARCHAR(100),                                                                     
// MAGIC    art_hier_lev3_code VARCHAR(100),                                                                     
// MAGIC    art_hier_lev3_name VARCHAR(100),                                                                     
// MAGIC    art_hier_lev4_code VARCHAR(100),                                                                     
// MAGIC    art_hier_lev4_name VARCHAR(100),                                                                     
// MAGIC    art_hier_lev5_code VARCHAR(100),                                                                     
// MAGIC    art_hier_lev5_name VARCHAR(100),                                                                     
// MAGIC    art_hier_lev6_code VARCHAR(100),                                                                     
// MAGIC    art_hier_lev6_name VARCHAR(100),                                                                     
// MAGIC    art_hier_lev7_code VARCHAR(100),                                                                     
// MAGIC    art_hier_lev7_name VARCHAR(100),                                                                     
// MAGIC    art_hier_lev8_code VARCHAR(100),                                                                     
// MAGIC    art_hier_lev8_name VARCHAR(100),                                                                     
// MAGIC    start_tsp TIMESTAMP,                                                                                 
// MAGIC    end_tsp TIMESTAMP,                                                                                   
// MAGIC    batch_id DECIMAL(10,0),                                                                              
// MAGIC    art_hier_lev5_concat VARCHAR(201),                                                                   
// MAGIC    art_str_col_concat VARCHAR(84),                                                                      
// MAGIC    art_variant_concat VARCHAR(59),                                                                      
// MAGIC    art_hier_lev6_concat VARCHAR(201),                                                                   
// MAGIC    art_hier_lev7_concat VARCHAR(201),                                                                   
// MAGIC    art_hier_lev8_concat VARCHAR(201),                                                                   
// MAGIC    hier_season VARCHAR(4),                                                                              
// MAGIC    units_per_tray INT,                                                                                  
// MAGIC    sun_ngt_shlf_life INT,                                                                               
// MAGIC    mon_ngt_shlf_life INT,                                                                               
// MAGIC    tue_ngt_shlf_life INT,                                                                               
// MAGIC    wed_ngt_shlf_life INT,                                                                               
// MAGIC    thu_ngt_shlf_life INT,                                                                               
// MAGIC    fri_ngt_shlf_life INT,                                                                               
// MAGIC    sat_ngt_shlf_life INT,                                                                               
// MAGIC    trays_per_layer INT,                                                                                 
// MAGIC    layers_per_pallet INT,                                                                               
// MAGIC    art_hier_lev2_concat VARCHAR(201),                                                                   
// MAGIC    art_hier_lev3_concat VARCHAR(201),                                                                   
// MAGIC    art_hier_lev4_concat VARCHAR(201),                                                                   
// MAGIC    alert_level DECIMAL(6,2),                                                                            
// MAGIC    grd_range_code VARCHAR(3),                                                                           
// MAGIC    grd_range_desc VARCHAR(50),                                                                          
// MAGIC    price_point DECIMAL(18,5),                                                                           
// MAGIC    child_article_id BIGINT,                                                                             
// MAGIC    parent_article_id BIGINT,                                                                            
// MAGIC    report_article_id BIGINT,                                                                            
// MAGIC    pri_sz_desc VARCHAR(10),                                                                             
// MAGIC    sec_sz_desc VARCHAR(10),                                                                             
// MAGIC    colour_desc VARCHAR(50),                                                                             
// MAGIC    parent_stroke VARCHAR(5),                                                                            
// MAGIC    parent_stroke_desc VARCHAR(40),                                                                      
// MAGIC    parent_colour_code VARCHAR(18),                                                                      
// MAGIC    parent_colour_desc VARCHAR(50),                                                                      
// MAGIC    report_stroke VARCHAR(5),                                                                            
// MAGIC    report_stroke_desc VARCHAR(40),                                                                      
// MAGIC    report_colour_code VARCHAR(18),                                                                      
// MAGIC    report_colour_desc VARCHAR(50),                                                                      
// MAGIC    tpatt_code VARCHAR(4),                                                                               
// MAGIC    tpatt_name VARCHAR(30),                                                                              
// MAGIC    srvc_avl_ratio DECIMAL(6,2),                                                                         
// MAGIC    art_hier_lev5_concat_gm_fd VARCHAR(201),                                                             
// MAGIC    art_hier_lev6_concat_gm VARCHAR(201),                                                                
// MAGIC    art_hier_lev7_concat_gm_fd VARCHAR(201),                                                             
// MAGIC    art_hier_lev8_concat_gm_fd VARCHAR(201),                                                             
// MAGIC    stroke_concat_gm_fd VARCHAR(201),                                                                    
// MAGIC    rep_stroke_colour_concat VARCHAR(201),                                                               
// MAGIC    dept_concat VARCHAR(201),                                                                            
// MAGIC    subdept_concat VARCHAR(201),                                                                         
// MAGIC    range_concat VARCHAR(201),                                                                           
// MAGIC    item_concat VARCHAR(201),                                                                            
// MAGIC    stroke_concat VARCHAR(201),                                                                          
// MAGIC    rsc_concat VARCHAR(201),                                                                             
// MAGIC    asc_concat VARCHAR(201),                                                                             
// MAGIC    csc_concat VARCHAR(201),                                                                             
// MAGIC    sap_article_no VARCHAR(201),                                                                         
// MAGIC    season_rollout VARCHAR(4),                                                                           
// MAGIC    action_ind VARCHAR(3),                                                                               
// MAGIC    price_band_desc VARCHAR(20),                                                                         
// MAGIC    colour_grp_code VARCHAR(6),                                                                          
// MAGIC    core_newness_desc VARCHAR(30),                                                                       
// MAGIC    brand_desc VARCHAR(30),                                                                              
// MAGIC    merchandise_cat_desc VARCHAR(20),                                                                    
// MAGIC    non_outlet_repl VARCHAR(4),                                                                          
// MAGIC    non_outlet_repl_desc VARCHAR(35),                                                                    
// MAGIC    outlet_repl VARCHAR(4),                                                                              
// MAGIC    outlet_repl_desc VARCHAR(35),                                                                        
// MAGIC    po_approval VARCHAR(4),                                                                              
// MAGIC    po_approval_desc VARCHAR(35),                                                                        
// MAGIC    supply_chain_type VARCHAR(10),                                                                       
// MAGIC    product_class_id VARCHAR(1),                                                                         
// MAGIC    serv_agreement VARCHAR(2),                                                                           
// MAGIC    sales_unit VARCHAR(3),                                                                               
// MAGIC    sales_unit_iso VARCHAR(3),                                                                           
// MAGIC    issue_unit VARCHAR(3),                                                                               
// MAGIC    issue_unit_iso VARCHAR(3),                                                                           
// MAGIC    art_country_of_origin VARCHAR(3),                                                                    
// MAGIC    art_country_of_origin_iso VARCHAR(2),                                                                
// MAGIC    art_region_of_origin VARCHAR(3),                                                                     
// MAGIC    assortment_grade VARCHAR(2),                                                                         
// MAGIC    ext_assortment_priority VARCHAR(1),                                                                  
// MAGIC    store_listing_proc VARCHAR(2),                                                                       
// MAGIC    dist_center_listing_proc VARCHAR(2),                                                                 
// MAGIC    store_listing_from_date TIMESTAMP,                                                                   
// MAGIC    store_listed_to_date TIMESTAMP,                                                                      
// MAGIC    dist_center_from_date TIMESTAMP,                                                                     
// MAGIC    dist_center_to_date TIMESTAMP,                                                                       
// MAGIC    store_sell_from_date TIMESTAMP,                                                                      
// MAGIC    store_sell_to_date TIMESTAMP,                                                                        
// MAGIC    dist_center_sell_from_date TIMESTAMP,                                                                
// MAGIC    dist_center_sell_to_date TIMESTAMP,                                                                  
// MAGIC    valuation_class VARCHAR(4),                                                                          
// MAGIC    valuation_margin VARCHAR(9),                                                                         
// MAGIC    coupon_disc_distr_prof VARCHAR(4),                                                                   
// MAGIC    active_assortment_list VARCHAR(1),                                                                   
// MAGIC    ext_merchandise_cat_desc VARCHAR(20),                                                                
// MAGIC    buying_ratio DECIMAL(5,2),                                                                           
// MAGIC    colour_group_name VARCHAR(50),                                                                       
// MAGIC    mdg_code VARCHAR(9),                                                                                 
// MAGIC    mdg_name VARCHAR(30),                                                                                
// MAGIC    default_mcd DECIMAL(10,0),                                                                           
// MAGIC    default_msc DECIMAL(10,0),                                                                           
// MAGIC    primary_vendor_no VARCHAR(10),                                                                       
// MAGIC    primary_vendor_name VARCHAR(40),                                                                     
// MAGIC    pack_content VARCHAR(5),                                                                             
// MAGIC    plan_a VARCHAR(30),                                                                                  
// MAGIC    plan_a2 VARCHAR(30),                                                                                 
// MAGIC    plan_a3 VARCHAR(30),                                                                                 
// MAGIC    plan_a4 VARCHAR(30),                                                                                 
// MAGIC    plan_a5 VARCHAR(30),                                                                                 
// MAGIC    plan_a6 VARCHAR(30),                                                                                 
// MAGIC    buyer_approval_ind VARCHAR(50),                                                                      
// MAGIC    min_credible_display DECIMAL(18,5),                                                                  
// MAGIC    parent_merchandising_id BIGINT,                                                                      
// MAGIC    g_sg_indicator VARCHAR(9)                                                                            
// MAGIC  )                                                                                                      
// MAGIC  USING PARQUET                                                                                      
// MAGIC  LOCATION '/mnt/onprem_data/blob/warehouse/raw/prod/ref_raw_prod.db/dim_article/'                                  

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC CREATE TABLE perf_test_blob.dim_dept (                                                                                                                     
// MAGIC    art_hier_lev1_code STRING,
// MAGIC    art_hier_lev1_name STRING,
// MAGIC    art_hier_lev2_code STRING,
// MAGIC    art_hier_lev2_name STRING,
// MAGIC    art_hier_lev3_code STRING,
// MAGIC    art_hier_lev3_name STRING,
// MAGIC    art_hier_lev4_code STRING,
// MAGIC    art_hier_lev4_name STRING,
// MAGIC    art_hier_lev5_code STRING,
// MAGIC    art_hier_lev5_name STRING,
// MAGIC    art_hier_lev2_concat STRING,
// MAGIC    art_hier_lev3_concat STRING,
// MAGIC    art_hier_lev4_concat STRING,
// MAGIC    art_hier_lev5_concat STRING,
// MAGIC    art_hier_lev5_concat_gm_fd STRING
// MAGIC  )
// MAGIC  USING PARQUET
// MAGIC  LOCATION '/mnt/onprem_data/blob/warehouse/raw/prod/ref_raw_prod.db/dim_dept/'
// MAGIC  

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC CREATE TABLE perf_test_blob.pim_product_data_hist (                                                                
// MAGIC    p_brand STRING,                                                                                                
// MAGIC    p_buyable STRING,                                                                                              
// MAGIC    p_description STRING,                                                                                          
// MAGIC    p_enddate STRING,                                                                                              
// MAGIC    p_fullimageurl STRING,                                                                                         
// MAGIC    p_instock STRING,                                                                                              
// MAGIC    p_is_reviewable STRING,                                                                                        
// MAGIC    p_ismanualassociation STRING,                                                                                  
// MAGIC    p_keywords STRING,                                                                                             
// MAGIC    p_lead_time STRING,                                                                                            
// MAGIC    p_lead_time_uom STRING,                                                                                        
// MAGIC    p_listmaxprice STRING,                                                                                         
// MAGIC    p_listminprice STRING,                                                                                         
// MAGIC    p_listprice STRING,                                                                                            
// MAGIC    p_mfpartnumber STRING,                                                                                         
// MAGIC    p_mns_product_type STRING,                                                                                     
// MAGIC    p_name STRING,                                                                                                 
// MAGIC    p_parentgroup_id STRING,                                                                                       
// MAGIC    p_parentproductid STRING,                                                                                      
// MAGIC    p_price_message_flag STRING,                                                                                   
// MAGIC    p_product_id STRING,                                                                                           
// MAGIC    p_product_info STRING,                                                                                         
// MAGIC    p_product_primary_category STRING,                                                                             
// MAGIC    p_productsku STRING,                                                                                           
// MAGIC    p_producttype STRING,                                                                                          
// MAGIC    p_producturl STRING,                                                                                           
// MAGIC    p_published STRING,                                                                                            
// MAGIC    p_rating STRING,                                                                                               
// MAGIC    p_reviews STRING,                                                                                              
// MAGIC    p_salemaxprice STRING,                                                                                         
// MAGIC    p_saleminprice STRING,                                                                                         
// MAGIC    p_template_id STRING,                                                                                          
// MAGIC    p_thumbnail STRING,                                                                                            
// MAGIC    s_buyable STRING,                                                                                              
// MAGIC    s_fullimageurl STRING,                                                                                         
// MAGIC    s_instock STRING,                                                                                              
// MAGIC    s_is_bulk_orderable STRING,                                                                                    
// MAGIC    s_is_gift_message_available STRING,                                                                            
// MAGIC    s_is_new STRING,                                                                                               
// MAGIC    s_is_product_gift_wrappable STRING,                                                                            
// MAGIC    s_is_product_returnable STRING,                                                                                
// MAGIC    s_ismanualassociation STRING,                                                                                  
// MAGIC    s_lead_time STRING,                                                                                            
// MAGIC    s_list_view_image STRING,                                                                                      
// MAGIC    s_listprice STRING,                                                                                            
// MAGIC    s_max_purchaseqty STRING,                                                                                      
// MAGIC    s_mfpartnumber STRING,                                                                                         
// MAGIC    s_pricetype STRING,                                                                                            
// MAGIC    s_product_set_price_indicator STRING,                                                                          
// MAGIC    s_published STRING,                                                                                            
// MAGIC    s_quantity STRING,                                                                                             
// MAGIC    s_release_date STRING,                                                                                         
// MAGIC    s_saleprice STRING,                                                                                            
// MAGIC    s_saleprice_flag STRING,                                                                                       
// MAGIC    s_sku_id STRING,                                                                                               
// MAGIC    s_swatch_image STRING,                                                                                         
// MAGIC    s_thumbnail STRING,                                                                                            
// MAGIC    xattr_alternatesizemapping STRING,                                                                             
// MAGIC    xattr_barcode STRING,                                                                                          
// MAGIC    xattr_blendedtaxcode STRING,                                                                                   
// MAGIC    xattr_caketype STRING,                                                                                         
// MAGIC    xattr_colourexact STRING,                                                                                      
// MAGIC    xattr_colourgroup STRING,                                                                                      
// MAGIC    xattr_colourgroup2 STRING,                                                                                     
// MAGIC    xattr_comparablepriceunit STRING,                                                                              
// MAGIC    xattr_compositionlist STRING,                                                                                  
// MAGIC    xattr_customerdeliveryfinishdate STRING,                                                                       
// MAGIC    xattr_customerfriendlyprimarysize STRING,                                                                      
// MAGIC    xattr_customerfriendlysecondarysize STRING,                                                                    
// MAGIC    xattr_ecomexclusive STRING,                                                                                    
// MAGIC    xattr_exactcolourforbeauty STRING,                                                                             
// MAGIC    xattr_exactcolourforcakes STRING,                                                                              
// MAGIC    xattr_fabric STRING,                                                                                           
// MAGIC    xattr_fabricnameforfurniture STRING,                                                                           
// MAGIC    xattr_fabrictype STRING,                                                                                       
// MAGIC    xattr_fit STRING,                                                                                              
// MAGIC    xattr_fulfilmentroute STRING,                                                                                  
// MAGIC    xattr_furniturefabrictype STRING,                                                                              
// MAGIC    xattr_ingredientslisting STRING,                                                                               
// MAGIC    xattr_packquantityforlink STRING,                                                                              
// MAGIC    xattr_paymentfrequency STRING,                                                                                 
// MAGIC    xattr_primarysizedescription STRING,                                                                           
// MAGIC    xattr_primarysizeindex STRING,                                                                                 
// MAGIC    xattr_primarysizeposition STRING,                                                                              
// MAGIC    xattr_primarysizerange STRING,                                                                                 
// MAGIC    xattr_saparticletype STRING,                                                                                   
// MAGIC    xattr_sapgenericarticleid STRING,                                                                              
// MAGIC    xattr_sapgenericarticlename STRING,                                                                            
// MAGIC    xattr_secondarysizedescription STRING,                                                                         
// MAGIC    xattr_secondarysizeindex STRING,                                                                               
// MAGIC    xattr_secondarysizeposition STRING,                                                                            
// MAGIC    xattr_secondarysizerange STRING,                                                                               
// MAGIC    xattr_servings STRING,                                                                                         
// MAGIC    xattr_specialcolour STRING,                                                                                    
// MAGIC    xattr_strokeid STRING,                                                                                         
// MAGIC    xattr_stylistsnotes STRING,                                                                                    
// MAGIC    xattr_subscriptionfrequency STRING,                                                                            
// MAGIC    xattr_subscriptionperiod STRING,                                                                               
// MAGIC    xattr_subscriptionplanname STRING,                                                                             
// MAGIC    xattr_subscriptionstartmonthsequence STRING,                                                                   
// MAGIC    xattr_taxcode STRING,                                                                                          
// MAGIC    xattr_taxindicator STRING,                                                                                     
// MAGIC    load_date TIMESTAMP                                                                                            
// MAGIC  )                                                                                                                
// MAGIC  USING PARQUET                                                                                                
// MAGIC  LOCATION '/mnt/onprem_data/blob/warehouse/raw/prod/ref_raw_prod.db/pim_product_data_hist/'

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC select * from ref_raw_prod.dim_article limit 10 ;

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC show create table perf_test_blob.dept_bu_article_lkp_view;

// COMMAND ----------

// MAGIC %sql 
// MAGIC 
// MAGIC CREATE VIEW perf_test_blob.dept_bu_product_lkp_view AS                                                                                                       
// MAGIC  SELECT A.PRODUCT_ID, A.bu, A.DEPT 
// MAGIC FROM (SELECT max(merchandising_id), CASE WHEN art_hier_lev2_name LIKE 'Food' THEN 'FOOD' ELSE upper(art_hier_lev3_name) END BU,
// MAGIC  substr(art_hier_lev5_code, 4, 3) dept,
// MAGIC  CASE WHEN art_hier_lev2_name = 'GM' THEN concat(substr(art_hier_lev5_code, 4, 3), Stroke) ELSE UPC END PRODUCT_ID
// MAGIC  FROM perf_test_blob.dim_article 
// MAGIC WHERE auth_grp IS NOT NULL AND UPC IS NOT NULL 
// MAGIC AND stroke IS NOT NULL AND art_hier_lev3_name IS NOT NULL 
// MAGIC GROUP BY 
// MAGIC CASE WHEN art_hier_lev2_name LIKE 'Food' THEN 'FOOD' ELSE upper(art_hier_lev3_name) END, 
// MAGIC substr(art_hier_lev5_code, 4, 3), CASE WHEN art_hier_lev2_name = 'GM' THEN concat(substr(art_hier_lev5_code, 4, 3), Stroke) ELSE UPC END 
// MAGIC ORDER BY 
// MAGIC CASE WHEN art_hier_lev2_name = 'GM' 
// MAGIC THEN concat(substr(art_hier_lev5_code, 4, 3), Stroke) 
// MAGIC ELSE UPC END ASC) a 
// MAGIC WHERE 
// MAGIC A.DEPT LIKE 'T%' AND length(A.PRODUCT_ID) > 0 OR A.DEPT LIKE 'F%' AND length(A.PRODUCT_ID) > 0 

// COMMAND ----------

// MAGIC %sql drop view perf_test_blob.dept_bu_lkp_view

// COMMAND ----------

// MAGIC %sql
// MAGIC CREATE VIEW perf_test_blob.dept_bu_lkp_view AS                                                                                                             
// MAGIC 
// MAGIC select substr(art_hier_lev5_code,4,3) Dept,
// MAGIC CASE
// MAGIC WHEN upper(substr(art_hier_lev5_code,4,3)) LIKE 'F%' THEN 'FOOD' 
// MAGIC WHEN art_hier_lev3_name LIKE '%HOME FURNISHINGS%' THEN 'HOME' ELSE upper(art_hier_lev3_name) END BU ,
// MAGIC CASE
// MAGIC WHEN upper(substr(art_hier_lev5_code,4,3)) LIKE 'F44' THEN 'FLOWERS' 
// MAGIC WHEN upper(substr(art_hier_lev5_code,4,3)) LIKE 'F18' THEN 'HAMPERS' 
// MAGIC WHEN upper(substr(art_hier_lev5_code,4,3)) LIKE 'F23' THEN 'WINE' 
// MAGIC WHEN upper(substr(art_hier_lev5_code,4,3)) LIKE 'F%' THEN 'FTO' 
// MAGIC WHEN upper(substr(art_hier_lev5_code,4,3)) LIKE 'T24' THEN 'FURNITURE' 
// MAGIC WHEN upper(substr(art_hier_lev5_code,4,3)) LIKE 'T39' THEN 'FURNITURE' 
// MAGIC WHEN upper(substr(art_hier_lev5_code,4,3)) LIKE 'T65' THEN 'FURNITURE' 
// MAGIC WHEN upper(substr(art_hier_lev5_code,4,3)) LIKE 'T84' THEN 'FURNITURE' ELSE upper(art_hier_lev3_name) END BU_ONLINE 
// MAGIC FROM perf_test_blob.dim_dept
// MAGIC WHERE 
// MAGIC substr(art_hier_lev5_code,4,3) LIKE 'T%'  OR  substr(art_hier_lev5_code,4,3) LIKE 'F%' 
// MAGIC ORDER BY  
// MAGIC substr(art_hier_lev5_code,4,3)ASC 

// COMMAND ----------

// MAGIC %sql
// MAGIC CREATE VIEW perf_test_blob.dept_bu_article_lkp_view AS      
// MAGIC SELECT A.article_no, A.product_id, A.description, A.bu, A.dept, b.p_product_id, 
// MAGIC b.article_no PIM_Article_no, b.p_producturl, b.p_mfpartnumber, b.p_fullimageurl 
// MAGIC 
// MAGIC FROM 
// MAGIC 
// MAGIC (SELECT A.article_no, A.PRODUCT_ID, A.Description, A.BU, A.DEPT 
// MAGIC 
// MAGIC FROM 
// MAGIC (
// MAGIC SELECT 
// MAGIC auth_grp Dept, 
// MAGIC CASE 
// MAGIC WHEN auth_grp LIKE 'F%' THEN 'FOOD' 
// MAGIC WHEN art_hier_lev3_name LIKE '%HOME FURNISHINGS%' THEN 'HOME' ELSE upper(art_hier_lev3_name) END BU, 
// MAGIC article_short_name Description, article_no, CASE WHEN art_hier_lev2_name = 'GM' THEN concat(auth_grp, Stroke) ELSE UPC END PRODUCT_ID 
// MAGIC FROM perf_test_blob.dim_article 
// MAGIC GROUP BY 
// MAGIC auth_grp, 
// MAGIC CASE WHEN auth_grp LIKE 'F%' THEN 'FOOD' WHEN art_hier_lev3_name LIKE '%HOME FURNISHINGS%' THEN 'HOME' ELSE upper(art_hier_lev3_name) END, 
// MAGIC article_short_name, article_no, 
// MAGIC CASE WHEN art_hier_lev2_name = 'GM' THEN concat(auth_grp, Stroke) ELSE UPC END) a 
// MAGIC  
// MAGIC WHERE 
// MAGIC A.DEPT LIKE 'T%' AND length(A.PRODUCT_ID) > 0 
// MAGIC OR 
// MAGIC A.DEPT LIKE 'F%' AND length(A.PRODUCT_ID) > 0) a 
// MAGIC 
// MAGIC LEFT OUTER JOIN 
// MAGIC 
// MAGIC (SELECT p_product_id, 
// MAGIC lpad(strleft(s_sku_id, 9), 18, '0') article_no, p_producturl, p_mfpartnumber, p_fullimageurl
// MAGIC 
// MAGIC  FROM
// MAGIC 
// MAGIC  perf_test_blob.pim_all_time_products a GROUP BY p_product_id, s_sku_id, p_producturl, p_mfpartnumber, p_fullimageurl)
// MAGIC 
// MAGIC  b ON A.article_no = B.Article_no GROUP BY A.article_no, A.product_id, 
// MAGIC A.description, A.bu, A.dept, b.p_product_id, b.article_no, 
// MAGIC b.p_producturl, b.p_mfpartnumber, b.p_fullimageurl

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC CREATE VIEW perf_test_blob.dept_bu_article_lkp_view AS 
// MAGIC SELECT A.article_no, A.product_id, A.description, A.bu, A.dept, b.p_product_id, 
// MAGIC b.article_no PIM_Article_no, b.p_producturl, b.p_mfpartnumber, b.p_fullimageurl 
// MAGIC FROM 
// MAGIC (SELECT A.article_no, A.PRODUCT_ID, A.Description, A.BU, A.DEPT 
// MAGIC FROM 
// MAGIC (
// MAGIC SELECT 
// MAGIC auth_grp Dept, 
// MAGIC CASE 
// MAGIC WHEN auth_grp LIKE 'F%' THEN 'FOOD' 
// MAGIC WHEN art_hier_lev3_name LIKE '%HOME FURNISHINGS%' THEN 'HOME' ELSE upper(art_hier_lev3_name) END BU, 
// MAGIC article_short_name Description, article_no, CASE WHEN art_hier_lev2_name = 'GM' THEN concat(auth_grp, Stroke) ELSE UPC END PRODUCT_ID 
// MAGIC FROM perf_test_blob.dim_article 
// MAGIC GROUP BY 
// MAGIC auth_grp, 
// MAGIC CASE WHEN auth_grp LIKE 'F%' THEN 'FOOD' WHEN art_hier_lev3_name LIKE '%HOME FURNISHINGS%' THEN 'HOME' ELSE upper(art_hier_lev3_name) END, 
// MAGIC article_short_name, article_no, 
// MAGIC CASE WHEN art_hier_lev2_name = 'GM' THEN concat(auth_grp, Stroke) ELSE UPC END) a 
// MAGIC WHERE 
// MAGIC A.DEPT LIKE 'T%' AND length(A.PRODUCT_ID) > 0 
// MAGIC OR 
// MAGIC A.DEPT LIKE 'F%' AND length(A.PRODUCT_ID) > 0) a LEFT OUTER JOIN (SELECT p_product_id, 
// MAGIC lpad(substr(s_sku_id,1, 9), 18, '0') article_no, p_producturl, p_mfpartnumber, p_fullimageurl
// MAGIC FROM
// MAGIC perf_test_blob.pim_all_time_products a GROUP BY p_product_id, s_sku_id, p_producturl, p_mfpartnumber, p_fullimageurl)
// MAGIC b ON A.article_no = B.Article_no GROUP BY A.article_no, A.product_id, 
// MAGIC A.description, A.bu, A.dept, b.p_product_id, b.article_no, 
// MAGIC b.p_producturl, b.p_mfpartnumber, b.p_fullimageurl

// COMMAND ----------

// MAGIC %sql 
// MAGIC 
// MAGIC SHOW PARTITIONS perf_test_blob.clk_raw_hist1

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC CREATE TABLE perf_test_blob.clk_raw_hist1 (                                                              
// MAGIC    accept_language STRING,                                                                                      
// MAGIC    browser BIGINT,                                                                                              
// MAGIC    browser_height BIGINT,                                                                                       
// MAGIC    browser_width BIGINT,                                                                                        
// MAGIC    c_color STRING,                                                                                              
// MAGIC    campaign STRING,                                                                                             
// MAGIC    carrier STRING,                                                                                              
// MAGIC    channel STRING,                                                                                              
// MAGIC    click_action STRING,                                                                                         
// MAGIC    click_action_type SMALLINT,                                                                                  
// MAGIC    click_context STRING,                                                                                        
// MAGIC    click_context_type SMALLINT,                                                                                 
// MAGIC    click_sourceid BIGINT,                                                                                       
// MAGIC    click_tag STRING,                                                                                            
// MAGIC    code_ver STRING,                                                                                             
// MAGIC    color BIGINT,                                                                                                
// MAGIC    connection_type SMALLINT,                                                                                    
// MAGIC    cookies STRING,                                                                                              
// MAGIC    country BIGINT,                                                                                              
// MAGIC    ct_connect_type STRING,                                                                                      
// MAGIC    curr_factor SMALLINT,                                                                                        
// MAGIC    curr_rate DECIMAL(24,12),                                                                                    
// MAGIC    currency STRING,                                                                                             
// MAGIC    cust_hit_time_gmt BIGINT,                                                                                    
// MAGIC    cust_visid STRING,                                                                                           
// MAGIC    daily_visitor SMALLINT,                                                                                      
// MAGIC    date_time TIMESTAMP,                                                                                         
// MAGIC    domain STRING,                                                                                               
// MAGIC    duplicate_events STRING,                                                                                     
// MAGIC    duplicate_purchase SMALLINT,                                                                                 
// MAGIC    duplicated_from STRING,                                                                                      
// MAGIC    evar1 STRING,                                                                                                
// MAGIC    evar10 STRING,                                                                                               
// MAGIC    evar11 STRING,                                                                                               
// MAGIC    evar12 STRING,                                                                                               
// MAGIC    evar13 STRING,                                                                                               
// MAGIC    evar14 STRING,                                                                                               
// MAGIC    evar15 STRING,                                                                                               
// MAGIC    evar16 STRING,                                                                                               
// MAGIC    evar17 STRING,                                                                                               
// MAGIC    evar18 STRING,                                                                                               
// MAGIC    evar19 STRING,                                                                                               
// MAGIC    evar2 STRING,                                                                                                
// MAGIC    evar20 STRING,                                                                                               
// MAGIC    evar21 STRING,                                                                                               
// MAGIC    evar22 STRING,                                                                                               
// MAGIC    evar23 STRING,                                                                                               
// MAGIC    evar24 STRING,                                                                                               
// MAGIC    evar25 STRING,                                                                                               
// MAGIC    evar26 STRING,                                                                                               
// MAGIC    evar27 STRING,                                                                                               
// MAGIC    evar28 STRING,                                                                                               
// MAGIC    evar29 STRING,                                                                                               
// MAGIC    evar3 STRING,                                                                                                
// MAGIC    evar30 STRING,                                                                                               
// MAGIC    evar31 STRING,                                                                                               
// MAGIC    evar32 STRING,                                                                                               
// MAGIC    evar33 STRING,                                                                                               
// MAGIC    evar34 STRING,                                                                                               
// MAGIC    evar35 STRING,                                                                                               
// MAGIC    evar36 STRING,                                                                                               
// MAGIC    evar37 STRING,                                                                                               
// MAGIC    evar38 STRING,                                                                                               
// MAGIC    evar39 STRING,                                                                                               
// MAGIC    evar4 STRING,                                                                                                
// MAGIC    evar40 STRING,                                                                                               
// MAGIC    evar41 STRING,                                                                                               
// MAGIC    evar42 STRING,                                                                                               
// MAGIC    evar43 STRING,                                                                                               
// MAGIC    evar44 STRING,                                                                                               
// MAGIC    evar45 STRING,                                                                                               
// MAGIC    evar46 STRING,                                                                                               
// MAGIC    evar47 STRING,                                                                                               
// MAGIC    evar48 STRING,                                                                                               
// MAGIC    evar49 STRING,                                                                                               
// MAGIC    evar5 STRING,                                                                                                
// MAGIC    evar50 STRING,                                                                                               
// MAGIC    evar51 STRING,                                                                                               
// MAGIC    evar52 STRING,                                                                                               
// MAGIC    evar53 STRING,                                                                                               
// MAGIC    evar54 STRING,                                                                                               
// MAGIC    evar55 STRING,                                                                                               
// MAGIC    evar56 STRING,                                                                                               
// MAGIC    evar57 STRING,                                                                                               
// MAGIC    evar58 STRING,                                                                                               
// MAGIC    evar59 STRING,                                                                                               
// MAGIC    evar6 STRING,                                                                                                
// MAGIC    evar60 STRING,                                                                                               
// MAGIC    evar61 STRING,                                                                                               
// MAGIC    evar62 STRING,                                                                                               
// MAGIC    evar63 STRING,                                                                                               
// MAGIC    evar64 STRING,                                                                                               
// MAGIC    evar65 STRING,                                                                                               
// MAGIC    evar66 STRING,                                                                                               
// MAGIC    evar67 STRING,                                                                                               
// MAGIC    evar68 STRING,                                                                                               
// MAGIC    evar69 STRING,                                                                                               
// MAGIC    evar7 STRING,                                                                                                
// MAGIC    evar70 STRING,                                                                                               
// MAGIC    evar71 STRING,                                                                                               
// MAGIC    evar72 STRING,                                                                                               
// MAGIC    evar73 STRING,                                                                                               
// MAGIC    evar74 STRING,                                                                                               
// MAGIC    evar75 STRING,                                                                                               
// MAGIC    evar8 STRING,                                                                                                
// MAGIC    evar9 STRING,                                                                                                
// MAGIC    event_list STRING,                                                                                           
// MAGIC    exclude_hit SMALLINT,                                                                                        
// MAGIC    first_hit_page_url STRING,                                                                                   
// MAGIC    first_hit_pagename STRING,                                                                                   
// MAGIC    first_hit_referrer STRING,                                                                                   
// MAGIC    first_hit_time_gmt BIGINT,                                                                                   
// MAGIC    geo_city STRING,                                                                                             
// MAGIC    geo_country STRING,                                                                                          
// MAGIC    geo_dma BIGINT,                                                                                              
// MAGIC    geo_region STRING,                                                                                           
// MAGIC    geo_zip STRING,                                                                                              
// MAGIC    hier1 STRING,                                                                                                
// MAGIC    hier2 STRING,                                                                                                
// MAGIC    hier3 STRING,                                                                                                
// MAGIC    hier4 STRING,                                                                                                
// MAGIC    hier5 STRING,                                                                                                
// MAGIC    hit_source SMALLINT,                                                                                         
// MAGIC    hit_time_gmt BIGINT,                                                                                         
// MAGIC    hitid_high STRING,                                                                                           
// MAGIC    hitid_low STRING,                                                                                            
// MAGIC    homepage STRING,                                                                                             
// MAGIC    hourly_visitor SMALLINT,                                                                                     
// MAGIC    ip STRING,                                                                                                   
// MAGIC    ip2 STRING,                                                                                                  
// MAGIC    j_jscript STRING,                                                                                            
// MAGIC    java_enabled STRING,                                                                                         
// MAGIC    javascript SMALLINT,                                                                                         
// MAGIC    language BIGINT,                                                                                             
// MAGIC    last_hit_time_gmt BIGINT,                                                                                    
// MAGIC    last_purchase_num BIGINT,                                                                                    
// MAGIC    last_purchase_time_gmt BIGINT,                                                                               
// MAGIC    mcvisid STRING,                                                                                              
// MAGIC    mobile_id BIGINT,                                                                                            
// MAGIC    mobileaction STRING,                                                                                         
// MAGIC    mobileappid STRING,                                                                                          
// MAGIC    mobilecampaigncontent STRING,                                                                                
// MAGIC    mobilecampaignmedium STRING,                                                                                 
// MAGIC    mobilecampaignname STRING,                                                                                   
// MAGIC    mobilecampaignsource STRING,                                                                                 
// MAGIC    mobilecampaignterm STRING,                                                                                   
// MAGIC    mobiledayofweek STRING,                                                                                      
// MAGIC    mobiledayssincefirstuse STRING,                                                                              
// MAGIC    mobiledayssincelastuse STRING,                                                                               
// MAGIC    mobiledevice STRING,                                                                                         
// MAGIC    mobilehourofday STRING,                                                                                      
// MAGIC    mobileinstalldate STRING,                                                                                    
// MAGIC    mobilelaunchnumber STRING,                                                                                   
// MAGIC    mobileltv STRING,                                                                                            
// MAGIC    mobileosversion STRING,                                                                                      
// MAGIC    mobileresolution STRING,                                                                                     
// MAGIC    monthly_visitor SMALLINT,                                                                                    
// MAGIC    mvvar1 STRING,                                                                                               
// MAGIC    mvvar2 STRING,                                                                                               
// MAGIC    mvvar3 STRING,                                                                                               
// MAGIC    namespace STRING,                                                                                            
// MAGIC    new_visit SMALLINT,                                                                                          
// MAGIC    os BIGINT,                                                                                                   
// MAGIC    p_plugins STRING,                                                                                            
// MAGIC    page_event SMALLINT,                                                                                         
// MAGIC    page_event_var1 STRING,                                                                                      
// MAGIC    page_event_var2 STRING,                                                                                      
// MAGIC    page_event_var3 STRING,                                                                                      
// MAGIC    page_type STRING,                                                                                            
// MAGIC    page_url STRING,                                                                                             
// MAGIC    pagename STRING,                                                                                             
// MAGIC    paid_search SMALLINT,                                                                                        
// MAGIC    partner_plugins STRING,                                                                                      
// MAGIC    persistent_cookie STRING,                                                                                    
// MAGIC    plugins STRING,                                                                                              
// MAGIC    pointofinterest STRING,                                                                                      
// MAGIC    pointofinterestdistance STRING,                                                                              
// MAGIC    post_browser_height BIGINT,                                                                                  
// MAGIC    post_browser_width BIGINT,                                                                                   
// MAGIC    post_campaign STRING,                                                                                        
// MAGIC    post_channel STRING,                                                                                         
// MAGIC    post_cookies STRING,                                                                                         
// MAGIC    post_currency STRING,                                                                                        
// MAGIC    post_cust_hit_time_gmt BIGINT,                                                                               
// MAGIC    post_cust_visid STRING,                                                                                      
// MAGIC    post_evar1 STRING,                                                                                           
// MAGIC    post_evar10 STRING,                                                                                          
// MAGIC    post_evar11 STRING,                                                                                          
// MAGIC    post_evar12 STRING,                                                                                          
// MAGIC    post_evar13 STRING,                                                                                          
// MAGIC    post_evar14 STRING,                                                                                          
// MAGIC    post_evar15 STRING,                                                                                          
// MAGIC    post_evar16 STRING,                                                                                          
// MAGIC    post_evar17 STRING,                                                                                          
// MAGIC    post_evar18 STRING,                                                                                          
// MAGIC    post_evar19 STRING,                                                                                          
// MAGIC    post_evar2 STRING,                                                                                           
// MAGIC    post_evar20 STRING,                                                                                          
// MAGIC    post_evar21 STRING,                                                                                          
// MAGIC    post_evar22 STRING,                                                                                          
// MAGIC    post_evar23 STRING,                                                                                          
// MAGIC    post_evar24 STRING,                                                                                          
// MAGIC    post_evar25 STRING,                                                                                          
// MAGIC    post_evar26 STRING,                                                                                          
// MAGIC    post_evar27 STRING,                                                                                          
// MAGIC    post_evar28 STRING,                                                                                          
// MAGIC    post_evar29 STRING,                                                                                          
// MAGIC    post_evar3 STRING,                                                                                           
// MAGIC    post_evar30 STRING,                                                                                          
// MAGIC    post_evar31 STRING,                                                                                          
// MAGIC    post_evar32 STRING,                                                                                          
// MAGIC    post_evar33 STRING,                                                                                          
// MAGIC    post_evar34 STRING,                                                                                          
// MAGIC    post_evar35 STRING,                                                                                          
// MAGIC    post_evar36 STRING,                                                                                          
// MAGIC    post_evar37 STRING,                                                                                          
// MAGIC    post_evar38 STRING,                                                                                          
// MAGIC    post_evar39 STRING,                                                                                          
// MAGIC    post_evar4 STRING,                                                                                           
// MAGIC    post_evar40 STRING,                                                                                          
// MAGIC    post_evar41 STRING,                                                                                          
// MAGIC    post_evar42 STRING,                                                                                          
// MAGIC    post_evar43 STRING,                                                                                          
// MAGIC    post_evar44 STRING,                                                                                          
// MAGIC    post_evar45 STRING,                                                                                          
// MAGIC    post_evar46 STRING,                                                                                          
// MAGIC    post_evar47 STRING,                                                                                          
// MAGIC    post_evar48 STRING,                                                                                          
// MAGIC    post_evar49 STRING,                                                                                          
// MAGIC    post_evar5 STRING,                                                                                           
// MAGIC    post_evar50 STRING,                                                                                          
// MAGIC    post_evar51 STRING,                                                                                          
// MAGIC    post_evar52 STRING,                                                                                          
// MAGIC    post_evar53 STRING,                                                                                          
// MAGIC    post_evar54 STRING,                                                                                          
// MAGIC    post_evar55 STRING,                                                                                          
// MAGIC    post_evar56 STRING,                                                                                          
// MAGIC    post_evar57 STRING,                                                                                          
// MAGIC    post_evar58 STRING,                                                                                          
// MAGIC    post_evar59 STRING,                                                                                          
// MAGIC    post_evar6 STRING,                                                                                           
// MAGIC    post_evar60 STRING,                                                                                          
// MAGIC    post_evar61 STRING,                                                                                          
// MAGIC    post_evar62 STRING,                                                                                          
// MAGIC    post_evar63 STRING,                                                                                          
// MAGIC    post_evar64 STRING,                                                                                          
// MAGIC    post_evar65 STRING,                                                                                          
// MAGIC    post_evar66 STRING,                                                                                          
// MAGIC    post_evar67 STRING,                                                                                          
// MAGIC    post_evar68 STRING,                                                                                          
// MAGIC    post_evar69 STRING,                                                                                          
// MAGIC    post_evar7 STRING,                                                                                           
// MAGIC    post_evar70 STRING,                                                                                          
// MAGIC    post_evar71 STRING,                                                                                          
// MAGIC    post_evar72 STRING,                                                                                          
// MAGIC    post_evar73 STRING,                                                                                          
// MAGIC    post_evar74 STRING,                                                                                          
// MAGIC    post_evar75 STRING,                                                                                          
// MAGIC    post_evar8 STRING,                                                                                           
// MAGIC    post_evar9 STRING,                                                                                           
// MAGIC    post_event_list STRING,                                                                                      
// MAGIC    post_hier1 STRING,                                                                                           
// MAGIC    post_hier2 STRING,                                                                                           
// MAGIC    post_hier3 STRING,                                                                                           
// MAGIC    post_hier4 STRING,                                                                                           
// MAGIC    post_hier5 STRING,                                                                                           
// MAGIC    post_java_enabled STRING,                                                                                    
// MAGIC    post_keywords STRING,                                                                                        
// MAGIC    post_mobileaction STRING,                                                                                    
// MAGIC    post_mobileappid STRING,                                                                                     
// MAGIC    post_mobilecampaigncontent STRING,                                                                           
// MAGIC    post_mobilecampaignmedium STRING,                                                                            
// MAGIC    post_mobilecampaignname STRING,                                                                              
// MAGIC    post_mobilecampaignsource STRING,                                                                            
// MAGIC    post_mobilecampaignterm STRING,                                                                              
// MAGIC    post_mobiledayofweek STRING,                                                                                 
// MAGIC    post_mobiledayssincefirstuse STRING,                                                                         
// MAGIC    post_mobiledayssincelastuse STRING,                                                                          
// MAGIC    post_mobiledevice STRING,                                                                                    
// MAGIC    post_mobilehourofday STRING,                                                                                 
// MAGIC    post_mobileinstalldate STRING,                                                                               
// MAGIC    post_mobilelaunchnumber STRING,                                                                              
// MAGIC    post_mobileltv STRING,                                                                                       
// MAGIC    post_mobileosversion STRING,                                                                                 
// MAGIC    post_mobileresolution STRING,                                                                                
// MAGIC    post_mvvar1 STRING,                                                                                          
// MAGIC    post_mvvar2 STRING,                                                                                          
// MAGIC    post_mvvar3 STRING,                                                                                          
// MAGIC    post_page_event SMALLINT,                                                                                    
// MAGIC    post_page_event_var1 STRING,                                                                                 
// MAGIC    post_page_event_var2 STRING,                                                                                 
// MAGIC    post_page_event_var3 STRING,                                                                                 
// MAGIC    post_page_type STRING,                                                                                       
// MAGIC    post_page_url STRING,                                                                                        
// MAGIC    post_pagename STRING,                                                                                        
// MAGIC    post_pagename_no_url STRING,                                                                                 
// MAGIC    post_partner_plugins STRING,                                                                                 
// MAGIC    post_persistent_cookie STRING,                                                                               
// MAGIC    post_pointofinterest STRING,                                                                                 
// MAGIC    post_pointofinterestdistance STRING,                                                                         
// MAGIC    post_product_list STRING,                                                                                    
// MAGIC    post_prop1 STRING,                                                                                           
// MAGIC    post_prop10 STRING,                                                                                          
// MAGIC    post_prop11 STRING,                                                                                          
// MAGIC    post_prop12 STRING,                                                                                          
// MAGIC    post_prop13 STRING,                                                                                          
// MAGIC    post_prop14 STRING,                                                                                          
// MAGIC    post_prop15 STRING,                                                                                          
// MAGIC    post_prop16 STRING,                                                                                          
// MAGIC    post_prop17 STRING,                                                                                          
// MAGIC    post_prop18 STRING,                                                                                          
// MAGIC    post_prop19 STRING,                                                                                          
// MAGIC    post_prop2 STRING,                                                                                           
// MAGIC    post_prop20 STRING,                                                                                          
// MAGIC    post_prop21 STRING,                                                                                          
// MAGIC    post_prop22 STRING,                                                                                          
// MAGIC    post_prop23 STRING,                                                                                          
// MAGIC    post_prop24 STRING,                                                                                          
// MAGIC    post_prop25 STRING,                                                                                          
// MAGIC    post_prop26 STRING,                                                                                          
// MAGIC    post_prop27 STRING,                                                                                          
// MAGIC    post_prop28 STRING,                                                                                          
// MAGIC    post_prop29 STRING,                                                                                          
// MAGIC    post_prop3 STRING,                                                                                           
// MAGIC    post_prop30 STRING,                                                                                          
// MAGIC    post_prop31 STRING,                                                                                          
// MAGIC    post_prop32 STRING,                                                                                          
// MAGIC    post_prop33 STRING,                                                                                          
// MAGIC    post_prop34 STRING,                                                                                          
// MAGIC    post_prop35 STRING,                                                                                          
// MAGIC    post_prop36 STRING,                                                                                          
// MAGIC    post_prop37 STRING,                                                                                          
// MAGIC    post_prop38 STRING,                                                                                          
// MAGIC    post_prop39 STRING,                                                                                          
// MAGIC    post_prop4 STRING,                                                                                           
// MAGIC    post_prop40 STRING,                                                                                          
// MAGIC    post_prop41 STRING,                                                                                          
// MAGIC    post_prop42 STRING,                                                                                          
// MAGIC    post_prop43 STRING,                                                                                          
// MAGIC    post_prop44 STRING,                                                                                          
// MAGIC    post_prop45 STRING,                                                                                          
// MAGIC    post_prop46 STRING,                                                                                          
// MAGIC    post_prop47 STRING,                                                                                          
// MAGIC    post_prop48 STRING,                                                                                          
// MAGIC    post_prop49 STRING,                                                                                          
// MAGIC    post_prop5 STRING,                                                                                           
// MAGIC    post_prop50 STRING,                                                                                          
// MAGIC    post_prop51 STRING,                                                                                          
// MAGIC    post_prop52 STRING,                                                                                          
// MAGIC    post_prop53 STRING,                                                                                          
// MAGIC    post_prop54 STRING,                                                                                          
// MAGIC    post_prop55 STRING,                                                                                          
// MAGIC    post_prop56 STRING,                                                                                          
// MAGIC    post_prop57 STRING,                                                                                          
// MAGIC    post_prop58 STRING,                                                                                          
// MAGIC    post_prop59 STRING,                                                                                          
// MAGIC    post_prop6 STRING,                                                                                           
// MAGIC    post_prop60 STRING,                                                                                          
// MAGIC    post_prop61 STRING,                                                                                          
// MAGIC    post_prop62 STRING,                                                                                          
// MAGIC    post_prop63 STRING,                                                                                          
// MAGIC    post_prop64 STRING,                                                                                          
// MAGIC    post_prop65 STRING,                                                                                          
// MAGIC    post_prop66 STRING,                                                                                          
// MAGIC    post_prop67 STRING,                                                                                          
// MAGIC    post_prop68 STRING,                                                                                          
// MAGIC    post_prop69 STRING,                                                                                          
// MAGIC    post_prop7 STRING,                                                                                           
// MAGIC    post_prop70 STRING,                                                                                          
// MAGIC    post_prop71 STRING,                                                                                          
// MAGIC    post_prop72 STRING,                                                                                          
// MAGIC    post_prop73 STRING,                                                                                          
// MAGIC    post_prop74 STRING,                                                                                          
// MAGIC    post_prop75 STRING,                                                                                          
// MAGIC    post_prop8 STRING,                                                                                           
// MAGIC    post_prop9 STRING,                                                                                           
// MAGIC    post_purchaseid STRING,                                                                                      
// MAGIC    post_referrer STRING,                                                                                        
// MAGIC    post_search_engine BIGINT,                                                                                   
// MAGIC    post_socialassettrackingcode STRING,                                                                         
// MAGIC    post_socialauthor STRING,                                                                                    
// MAGIC    post_socialaveragesentiment STRING,                                                                          
// MAGIC    post_socialcontentprovider STRING,                                                                           
// MAGIC    post_sociallanguage STRING,                                                                                  
// MAGIC    post_sociallatlong STRING,                                                                                   
// MAGIC    post_sociallink STRING,                                                                                      
// MAGIC    post_socialproperty STRING,                                                                                  
// MAGIC    post_socialterm STRING,                                                                                      
// MAGIC    post_socialtermslist STRING,                                                                                 
// MAGIC    post_state STRING,                                                                                           
// MAGIC    post_survey STRING,                                                                                          
// MAGIC    post_t_time_info STRING,                                                                                     
// MAGIC    post_tnt STRING,                                                                                             
// MAGIC    post_tnt_action STRING,                                                                                      
// MAGIC    post_transactionid STRING,                                                                                   
// MAGIC    post_video STRING,                                                                                           
// MAGIC    post_videoad STRING,                                                                                         
// MAGIC    post_videoadinpod STRING,                                                                                    
// MAGIC    post_videoadplayername STRING,                                                                               
// MAGIC    post_videoadpod STRING,                                                                                      
// MAGIC    post_videochannel STRING,                                                                                    
// MAGIC    post_videocontenttype STRING,                                                                                
// MAGIC    post_videopath STRING,                                                                                       
// MAGIC    post_videoplayername STRING,                                                                                 
// MAGIC    post_videosegment STRING,                                                                                    
// MAGIC    post_visid_high STRING,                                                                                      
// MAGIC    post_visid_low STRING,                                                                                       
// MAGIC    post_visid_type SMALLINT,                                                                                    
// MAGIC    post_zip STRING,                                                                                             
// MAGIC    prev_page BIGINT,                                                                                            
// MAGIC    product_list STRING,                                                                                         
// MAGIC    product_merchandising STRING,                                                                                
// MAGIC    prop1 STRING,                                                                                                
// MAGIC    prop10 STRING,                                                                                               
// MAGIC    prop11 STRING,                                                                                               
// MAGIC    prop12 STRING,                                                                                               
// MAGIC    prop13 STRING,                                                                                               
// MAGIC    prop14 STRING,                                                                                               
// MAGIC    prop15 STRING,                                                                                               
// MAGIC    prop16 STRING,                                                                                               
// MAGIC    prop17 STRING,                                                                                               
// MAGIC    prop18 STRING,                                                                                               
// MAGIC    prop19 STRING,                                                                                               
// MAGIC    prop2 STRING,                                                                                                
// MAGIC    prop20 STRING,                                                                                               
// MAGIC    prop21 STRING,                                                                                               
// MAGIC    prop22 STRING,                                                                                               
// MAGIC    prop23 STRING,                                                                                               
// MAGIC    prop24 STRING,                                                                                               
// MAGIC    prop25 STRING,                                                                                               
// MAGIC    prop26 STRING,                                                                                               
// MAGIC    prop27 STRING,                                                                                               
// MAGIC    prop28 STRING,                                                                                               
// MAGIC    prop29 STRING,                                                                                               
// MAGIC    prop3 STRING,                                                                                                
// MAGIC    prop30 STRING,                                                                                               
// MAGIC    prop31 STRING,                                                                                               
// MAGIC    prop32 STRING,                                                                                               
// MAGIC    prop33 STRING,                                                                                               
// MAGIC    prop34 STRING,                                                                                               
// MAGIC    prop35 STRING,                                                                                               
// MAGIC    prop36 STRING,                                                                                               
// MAGIC    prop37 STRING,                                                                                               
// MAGIC    prop38 STRING,                                                                                               
// MAGIC    prop39 STRING,                                                                                               
// MAGIC    prop4 STRING,                                                                                                
// MAGIC    prop40 STRING,                                                                                               
// MAGIC    prop41 STRING,                                                                                               
// MAGIC    prop42 STRING,                                                                                               
// MAGIC    prop43 STRING,                                                                                               
// MAGIC    prop44 STRING,                                                                                               
// MAGIC    prop45 STRING,                                                                                               
// MAGIC    prop46 STRING,                                                                                               
// MAGIC    prop47 STRING,                                                                                               
// MAGIC    prop48 STRING,                                                                                               
// MAGIC    prop49 STRING,                                                                                               
// MAGIC    prop5 STRING,                                                                                                
// MAGIC    prop50 STRING,                                                                                               
// MAGIC    prop51 STRING,                                                                                               
// MAGIC    prop52 STRING,                                                                                               
// MAGIC    prop53 STRING,                                                                                               
// MAGIC    prop54 STRING,                                                                                               
// MAGIC    prop55 STRING,                                                                                               
// MAGIC    prop56 STRING,                                                                                               
// MAGIC    prop57 STRING,                                                                                               
// MAGIC    prop58 STRING,                                                                                               
// MAGIC    prop59 STRING,                                                                                               
// MAGIC    prop6 STRING,                                                                                                
// MAGIC    prop60 STRING,                                                                                               
// MAGIC    prop61 STRING,                                                                                               
// MAGIC    prop62 STRING,                                                                                               
// MAGIC    prop63 STRING,                                                                                               
// MAGIC    prop64 STRING,                                                                                               
// MAGIC    prop65 STRING,                                                                                               
// MAGIC    prop66 STRING,                                                                                               
// MAGIC    prop67 STRING,                                                                                               
// MAGIC    prop68 STRING,                                                                                               
// MAGIC    prop69 STRING,                                                                                               
// MAGIC    prop7 STRING,                                                                                                
// MAGIC    prop70 STRING,                                                                                               
// MAGIC    prop71 STRING,                                                                                               
// MAGIC    prop72 STRING,                                                                                               
// MAGIC    prop73 STRING,                                                                                               
// MAGIC    prop74 STRING,                                                                                               
// MAGIC    prop75 STRING,                                                                                               
// MAGIC    prop8 STRING,                                                                                                
// MAGIC    prop9 STRING,                                                                                                
// MAGIC    purchaseid STRING,                                                                                           
// MAGIC    quarterly_visitor SMALLINT,                                                                                  
// MAGIC    ref_domain STRING,                                                                                           
// MAGIC    ref_type SMALLINT,                                                                                           
// MAGIC    referrer STRING,                                                                                             
// MAGIC    resolution BIGINT,                                                                                           
// MAGIC    s_resolution STRING,                                                                                         
// MAGIC    sampled_hit STRING,                                                                                          
// MAGIC    search_engine BIGINT,                                                                                        
// MAGIC    search_page_num BIGINT,                                                                                      
// MAGIC    secondary_hit STRING,                                                                                        
// MAGIC    service STRING,                                                                                              
// MAGIC    socialassettrackingcode STRING,                                                                              
// MAGIC    socialauthor STRING,                                                                                         
// MAGIC    socialaveragesentiment STRING,                                                                               
// MAGIC    socialcontentprovider STRING,                                                                                
// MAGIC    sociallanguage STRING,                                                                                       
// MAGIC    sociallatlong STRING,                                                                                        
// MAGIC    sociallink STRING,                                                                                           
// MAGIC    socialproperty STRING,                                                                                       
// MAGIC    socialterm STRING,                                                                                           
// MAGIC    socialtermslist STRING,                                                                                      
// MAGIC    sourceid BIGINT,                                                                                             
// MAGIC    state STRING,                                                                                                
// MAGIC    stats_server STRING,                                                                                         
// MAGIC    t_time_info STRING,                                                                                          
// MAGIC    tnt STRING,                                                                                                  
// MAGIC    tnt_action STRING,                                                                                           
// MAGIC    tnt_post_vista STRING,                                                                                       
// MAGIC    transactionid STRING,                                                                                        
// MAGIC    truncated_hit STRING,                                                                                        
// MAGIC    ua_color STRING,                                                                                             
// MAGIC    ua_os STRING,                                                                                                
// MAGIC    ua_pixels STRING,                                                                                            
// MAGIC    user_agent STRING,                                                                                           
// MAGIC    user_hash BIGINT,                                                                                            
// MAGIC    user_server STRING,                                                                                          
// MAGIC    userid BIGINT,                                                                                               
// MAGIC    username STRING,                                                                                             
// MAGIC    va_closer_detail STRING,                                                                                     
// MAGIC    va_closer_id SMALLINT,                                                                                       
// MAGIC    va_finder_detail STRING,                                                                                     
// MAGIC    va_finder_id SMALLINT,                                                                                       
// MAGIC    va_instance_event SMALLINT,                                                                                  
// MAGIC    va_new_engagement SMALLINT,                                                                                  
// MAGIC    video STRING,                                                                                                
// MAGIC    videoad STRING,                                                                                              
// MAGIC    videoadinpod STRING,                                                                                         
// MAGIC    videoadplayername STRING,                                                                                    
// MAGIC    videoadpod STRING,                                                                                           
// MAGIC    videochannel STRING,                                                                                         
// MAGIC    videocontenttype STRING,                                                                                     
// MAGIC    videopath STRING,                                                                                            
// MAGIC    videoplayername STRING,                                                                                      
// MAGIC    videosegment STRING,                                                                                         
// MAGIC    visid_high STRING,                                                                                           
// MAGIC    visid_low STRING,                                                                                            
// MAGIC    visid_new STRING,                                                                                            
// MAGIC    visid_timestamp BIGINT,                                                                                      
// MAGIC    visid_type SMALLINT,                                                                                         
// MAGIC    visit_keywords STRING,                                                                                       
// MAGIC    visit_num BIGINT,                                                                                            
// MAGIC    visit_page_num BIGINT,                                                                                       
// MAGIC    visit_referrer STRING,                                                                                       
// MAGIC    visit_search_engine BIGINT,                                                                                  
// MAGIC    visit_start_page_url STRING,                                                                                 
// MAGIC    visit_start_pagename STRING,                                                                                 
// MAGIC    visit_start_time_gmt BIGINT,                                                                                 
// MAGIC    weekly_visitor SMALLINT,                                                                                     
// MAGIC    yearly_visitor SMALLINT,                                                                                     
// MAGIC    zip STRING,                                                                                                  
// MAGIC    eah_file_id INT,
// MAGIC    year INT,                                                                                                    
// MAGIC    month INT,                                                                                                   
// MAGIC    day INT,                                                                                                     
// MAGIC    eah_raw_batch_id INT    
// MAGIC  )    
// MAGIC USING PARQUET 
// MAGIC  PARTITIONED BY ( year,month,day,eah_raw_batch_id )
// MAGIC  LOCATION '/mnt/onprem_data/blob/warehouse/raw/prod/clickstream_raw_prod.db/clk_raw_hist1'                                

// COMMAND ----------

// MAGIC %sql
// MAGIC 
// MAGIC 
// MAGIC CREATE TABLE perf_test_blob.hit_data_royce (accept_language STRING, browser STRING, browser_height STRING, browser_width STRING, c_color STRING, campaign STRING, carrier STRING, channel STRING, click_action STRING, click_action_type STRING, click_context STRING, click_context_type STRING, click_sourceid STRING, click_tag STRING, code_ver STRING, color STRING, connection_type STRING, cookies STRING, country STRING, ct_connect_type STRING, curr_factor STRING, curr_rate STRING, currency STRING, cust_hit_time_gmt STRING, cust_visid STRING, daily_visitor STRING, date_time STRING, domain STRING, duplicate_events STRING, duplicate_purchase STRING, duplicated_from STRING, evar1 STRING, evar10 STRING, evar11 STRING, evar12 STRING, evar13 STRING, evar14 STRING, evar15 STRING, evar16 STRING, evar17 STRING, evar18 STRING, evar19 STRING, evar2 STRING, evar20 STRING, evar21 STRING, evar22 STRING, evar23 STRING, evar24 STRING, evar25 STRING, evar26 STRING, evar27 STRING, evar28 STRING, evar29 STRING, evar3 STRING, evar30 STRING, evar31 STRING, evar32 STRING, evar33 STRING, evar34 STRING, evar35 STRING, evar36 STRING, evar37 STRING, evar38 STRING, evar39 STRING, evar4 STRING, evar40 STRING, evar41 STRING, evar42 STRING, evar43 STRING, evar44 STRING, evar45 STRING, evar46 STRING, evar47 STRING, evar48 STRING, evar49 STRING, evar5 STRING, evar50 STRING, evar51 STRING, evar52 STRING, evar53 STRING, evar54 STRING, evar55 STRING, evar56 STRING, evar57 STRING, evar58 STRING, evar59 STRING, evar6 STRING, evar60 STRING, evar61 STRING, evar62 STRING, evar63 STRING, evar64 STRING, evar65 STRING, evar66 STRING, evar67 STRING, evar68 STRING, evar69 STRING, evar7 STRING, evar70 STRING, evar71 STRING, evar72 STRING, evar73 STRING, evar74 STRING, evar75 STRING, evar8 STRING, evar9 STRING, event_list STRING, exclude_hit STRING, first_hit_page_url STRING, first_hit_pagename STRING, first_hit_referrer STRING, first_hit_time_gmt STRING, geo_city STRING, geo_country STRING, geo_dma STRING, geo_region STRING, geo_zip STRING, hier1 STRING, hier2 STRING, hier3 STRING, hier4 STRING, hier5 STRING, hit_source STRING, hit_time_gmt STRING, hitid_high STRING, hitid_low STRING, homepage STRING, hourly_visitor STRING, ip STRING, ip2 STRING, j_jscript STRING, java_enabled STRING, javascript STRING, LANGUAGE STRING, last_hit_time_gmt STRING, last_purchase_num STRING, last_purchase_time_gmt STRING, mcvisid STRING, mobile_id STRING, mobileaction STRING, mobileappid STRING, mobilecampaigncontent STRING, mobilecampaignmedium STRING, mobilecampaignname STRING, mobilecampaignsource STRING, mobilecampaignterm STRING, mobiledayofweek STRING, mobiledayssincefirstuse STRING, mobiledayssincelastuse STRING, mobiledevice STRING, mobilehourofday STRING, mobileinstalldate STRING, mobilelaunchnumber STRING, mobileltv STRING, mobileosversion STRING, mobileresolution STRING, monthly_visitor STRING, mvvar1 STRING, mvvar2 STRING, mvvar3 STRING, namespace STRING, new_visit STRING, os STRING, p_plugins STRING, page_event STRING, page_event_var1 STRING, page_event_var2 STRING, page_event_var3 STRING, page_type STRING, page_url STRING, pagename STRING, paid_search STRING, partner_plugins STRING, persistent_cookie STRING, plugins STRING, pointofinterest STRING, pointofinterestdistance STRING, post_browser_height STRING, post_browser_width STRING, post_campaign STRING, post_channel STRING, post_cookies STRING, post_currency STRING, post_cust_hit_time_gmt STRING, post_cust_visid STRING, post_evar1 STRING, post_evar10 STRING, post_evar11 STRING, post_evar12 STRING, post_evar13 STRING, post_evar14 STRING, post_evar15 STRING, post_evar16 STRING, post_evar17 STRING, post_evar18 STRING, post_evar19 STRING, post_evar2 STRING, post_evar20 STRING, post_evar21 STRING, post_evar22 STRING, post_evar23 STRING, post_evar24 STRING, post_evar25 STRING, post_evar26 STRING, post_evar27 STRING, post_evar28 STRING, post_evar29 STRING, post_evar3 STRING, post_evar30 STRING, post_evar31 STRING, post_evar32 STRING, post_evar33 STRING, post_evar34 STRING, post_evar35 STRING, post_evar36 STRING, post_evar37 STRING, post_evar38 STRING, post_evar39 STRING, post_evar4 STRING, post_evar40 STRING, post_evar41 STRING, post_evar42 STRING, post_evar43 STRING, post_evar44 STRING, post_evar45 STRING, post_evar46 STRING, post_evar47 STRING, post_evar48 STRING, post_evar49 STRING, post_evar5 STRING, post_evar50 STRING, post_evar51 STRING, post_evar52 STRING, post_evar53 STRING, post_evar54 STRING, post_evar55 STRING, post_evar56 STRING, post_evar57 STRING, post_evar58 STRING, post_evar59 STRING, post_evar6 STRING, post_evar60 STRING, post_evar61 STRING, post_evar62 STRING, post_evar63 STRING, post_evar64 STRING, post_evar65 STRING, post_evar66 STRING, post_evar67 STRING, post_evar68 STRING, post_evar69 STRING, post_evar7 STRING, post_evar70 STRING, post_evar71 STRING, post_evar72 STRING, post_evar73 STRING, post_evar74 STRING, post_evar75 STRING, post_evar8 STRING, post_evar9 STRING, post_event_list STRING, post_hier1 STRING, post_hier2 STRING, post_hier3 STRING, post_hier4 STRING, post_hier5 STRING, post_java_enabled STRING, post_keywords STRING, post_mobileaction STRING, post_mobileappid STRING, post_mobilecampaigncontent STRING, post_mobilecampaignmedium STRING, post_mobilecampaignname STRING, post_mobilecampaignsource STRING, post_mobilecampaignterm STRING, post_mobiledayofweek STRING, post_mobiledayssincefirstuse STRING, post_mobiledayssincelastuse STRING, post_mobiledevice STRING, post_mobilehourofday STRING, post_mobileinstalldate STRING, post_mobilelaunchnumber STRING, post_mobileltv STRING, post_mobileosversion STRING, post_mobileresolution STRING, post_mvvar1 STRING, post_mvvar2 STRING, post_mvvar3 STRING, post_page_event STRING, post_page_event_var1 STRING, post_page_event_var2 STRING, post_page_event_var3 STRING, post_page_type STRING, post_page_url STRING, post_pagename STRING, post_pagename_no_url STRING, post_partner_plugins STRING, post_persistent_cookie STRING, post_pointofinterest STRING, post_pointofinterestdistance STRING, post_product_list STRING, post_prop1 STRING, post_prop10 STRING, post_prop11 STRING, post_prop12 STRING, post_prop13 STRING, post_prop14 STRING, post_prop15 STRING, post_prop16 STRING, post_prop17 STRING, post_prop18 STRING, post_prop19 STRING, post_prop2 STRING, post_prop20 STRING, post_prop21 STRING, post_prop22 STRING, post_prop23 STRING, post_prop24 STRING, post_prop25 STRING, post_prop26 STRING, post_prop27 STRING, post_prop28 STRING, post_prop29 STRING, post_prop3 STRING, post_prop30 STRING, post_prop31 STRING, post_prop32 STRING, post_prop33 STRING, post_prop34 STRING, post_prop35 STRING, post_prop36 STRING, post_prop37 STRING, post_prop38 STRING, post_prop39 STRING, post_prop4 STRING, post_prop40 STRING, post_prop41 STRING, post_prop42 STRING, post_prop43 STRING, post_prop44 STRING, post_prop45 STRING, post_prop46 STRING, post_prop47 STRING, post_prop48 STRING, post_prop49 STRING, post_prop5 STRING, post_prop50 STRING, post_prop51 STRING, post_prop52 STRING, post_prop53 STRING, post_prop54 STRING, post_prop55 STRING, post_prop56 STRING, post_prop57 STRING, post_prop58 STRING, post_prop59 STRING, post_prop6 STRING, post_prop60 STRING, post_prop61 STRING, post_prop62 STRING, post_prop63 STRING, post_prop64 STRING, post_prop65 STRING, post_prop66 STRING, post_prop67 STRING, post_prop68 STRING, post_prop69 STRING, post_prop7 STRING, post_prop70 STRING, post_prop71 STRING, post_prop72 STRING, post_prop73 STRING, post_prop74 STRING, post_prop75 STRING, post_prop8 STRING, post_prop9 STRING, post_purchaseid STRING, post_referrer STRING, post_search_engine STRING, post_socialassettrackingcode STRING, post_socialauthor STRING, post_socialaveragesentiment STRING, post_socialcontentprovider STRING, post_sociallanguage STRING, post_sociallatlong STRING, post_sociallink STRING, post_socialproperty STRING, post_socialterm STRING, post_socialtermslist STRING, post_state STRING, post_survey STRING, post_t_time_info STRING, post_tnt STRING, post_tnt_action STRING, post_transactionid STRING, post_video STRING, post_videoad STRING, post_videoadinpod STRING, post_videoadplayername STRING, post_videoadpod STRING, post_videochannel STRING, post_videocontenttype STRING, post_videopath STRING, post_videoplayername STRING, post_videosegment STRING, post_visid_high STRING, post_visid_low STRING, post_visid_type STRING, post_zip STRING, prev_page STRING, product_list STRING, product_merchandising STRING, prop1 STRING, prop10 STRING, prop11 STRING, prop12 STRING, prop13 STRING, prop14 STRING, prop15 STRING, prop16 STRING, prop17 STRING, prop18 STRING, prop19 STRING, prop2 STRING, prop20 STRING, prop21 STRING, prop22 STRING, prop23 STRING, prop24 STRING, prop25 STRING, prop26 STRING, prop27 STRING, prop28 STRING, prop29 STRING, prop3 STRING, prop30 STRING, prop31 STRING, prop32 STRING, prop33 STRING, prop34 STRING, prop35 STRING, prop36 STRING, prop37 STRING, prop38 STRING, prop39 STRING, prop4 STRING, prop40 STRING, prop41 STRING, prop42 STRING, prop43 STRING, prop44 STRING, prop45 STRING, prop46 STRING, prop47 STRING, prop48 STRING, prop49 STRING, prop5 STRING, prop50 STRING, prop51 STRING, prop52 STRING, prop53 STRING, prop54 STRING, prop55 STRING, prop56 STRING, prop57 STRING, prop58 STRING, prop59 STRING, prop6 STRING, prop60 STRING, prop61 STRING, prop62 STRING, prop63 STRING, prop64 STRING, prop65 STRING, prop66 STRING, prop67 STRING, prop68 STRING, prop69 STRING, prop7 STRING, prop70 STRING, prop71 STRING, prop72 STRING, prop73 STRING, prop74 STRING, prop75 STRING, prop8 STRING, prop9 STRING, purchaseid STRING, quarterly_visitor STRING, ref_domain STRING, ref_type STRING, referrer STRING, resolution STRING, s_resolution STRING, sampled_hit STRING, search_engine STRING, search_page_num STRING, secondary_hit STRING, service STRING, socialassettrackingcode STRING, socialauthor STRING, socialaveragesentiment STRING, socialcontentprovider STRING, sociallanguage STRING, sociallatlong STRING, sociallink STRING, socialproperty STRING, socialterm STRING, socialtermslist STRING, sourceid STRING, STATE STRING, stats_server STRING, t_time_info STRING, tnt STRING, tnt_action STRING, tnt_post_vista STRING, transactionid STRING, truncated_hit STRING, ua_color STRING, ua_os STRING, ua_pixels STRING, user_hash STRING, user_server STRING, userid STRING, username STRING, va_closer_detail STRING, va_closer_id STRING, va_finder_detail STRING, va_finder_id STRING, va_instance_event STRING, va_new_engagement STRING, video STRING, videoad STRING, videoadinpod STRING, videoadplayername STRING, videoadpod STRING, videochannel STRING, videocontenttype STRING, videopath STRING, videoplayername STRING, videosegment STRING, visid_high STRING, visid_low STRING, visid_new STRING, visid_timestamp STRING, visid_type STRING, visit_keywords STRING, visit_num STRING, visit_page_num STRING, visit_referrer STRING, visit_search_engine STRING, visit_start_page_url STRING, visit_start_pagename STRING, visit_start_time_gmt STRING, weekly_visitor STRING, yearly_visitor STRING, zip STRING, year INT, month INT, day INT)
// MAGIC USING com.databricks.spark.avro
// MAGIC OPTIONS (
// MAGIC   serialization.format '1',
// MAGIC   path 'dbfs:/mnt/clickstream_out/raw_hit_data'
// MAGIC )
// MAGIC PARTITIONED BY (year, month, day)

// COMMAND ----------

// MAGIC %sql
// MAGIC create view perf_test_blob.clk_raw as
// MAGIC 
// MAGIC select * from perf_test_blob.clk_raw_hist1
// MAGIC union all
// MAGIC select * from perf_test_blob.hit_data_royce

// COMMAND ----------

// MAGIC %sql 
// MAGIC 
// MAGIC show create table perf_test_blob.clickstream;